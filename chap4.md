chapter 4 파일 입출력

리눅스에서 파일을 읽고 쓰는 방법은 저수준 파일 입출력, 고수준 파일 입출력으로 분류한다.

1. 저수준 파일 입출력
   바이트 단위로 입출력을 수행하므로 해당 함수 자체의 구조는 단순하다.

   파일 기술자
     현재 열려 있는 파일을 구분할 목적으로 시스템에서 붙여놓은 번호이며, 열린 파일을 참조하는 데 사용하는 지시자 역할을 한다.
     정숫값이며, open() 함수를 사용해 파일을 열 때 부여된다.
     0번: 표준 입력, 1번: 표준 출력, 2번: 표준 오류
     0번은 키보드, 1,2번은 모니터 화면을 의미한다.
     프로세스가 파일을 열 때 파일 기술자에는 0번부터 순서대로 가장 작은 번호가 자동 할당된다.
     물론 처음 동작시 0,1,2번은 자동 할당되기에 3번부터 할당된다.

  파일 생성과 열고 닫기
    파일을 연다는 것은 파일의 내용을 읽거나 파일에 내용을 쓸 수 있는 상태로 변경하는 것을 의미한다.
    작업을 완료하면 파일을 닫아야 한다. 그래야 파일의 내용을 하드 디스크에 온전히 기록하고 파일이 사용한 버퍼 등을 반납할 수 있다.

    open(): 파일 열기
    ---------------------------------------------------------
    #include <sys/types.h>
    #include <sys/stat.h>
    #include <fcntl.h>

    int open(const char *pathname, int flags);
    int open(const char *pathname, int flags, mode_t mode);

    * pathname: 열려는 파일이 있는 경로
    * flags: 파일 상태 플래그
    * mode: 접근 권한
    --------------------------------------------------------
    open() 함수는 pathname에 지정한 파일을 flags에 지정한 상태 플래그의 값에 따라 열고 파일 기술자를 반환한다. 
    파일의 상태를 조정하는 flags 값은 man 명령으로 확인할 수 있다.
    O_RDONLY
    O_WRONLY
    O_RDWR
    O_CREAT
    O_EXCL
    O_APPEND
    O_TRUNC
    O_SYNC/O_DSYNC

    플래그는 OR(|) 연산자로 지정 가능
    쓰기 전용으로 열 때(파일이 있는 경우) : O_WRONLY | O_TRUNC
    쓰기 전용으로 열 때(파일이 없는 경우) : O_WRONLY | O_CREAT | O_TRUNC
    읽기/쓰기/추가용으로 열 때 : O_RDWR | O_APPEND

    mode는 파일의 접근 권한을 설정하는 것이며, O_CREAT를 지정해 파일을 생성할 때만 사용
    open() 함수는 파일 열기에 성공하면 파일 기술자를 리턴한다.

    creat() : 파일 생성
    -----------------------------------------------------------
    #include <sys/types.h>
    #include <sys/stat.h>
    #include <fcntl.h>

    int creat(const char *pathname, mode_t mode);

    * pathname: 파일을 생성할 경로
    * mode: 접근 권한
    -----------------------------------------------------------
    creat() 함수는 파일을 생성하는 전용 함수이며, open()과 다르게 플래그를 지정하는 부분이 없다.

    close() : 파일 닫기
    -----------------------------------------------------------
    #include <unistd.h>

    int close(int fd);

    * fd: 파일 기술자
    -----------------------------------------------------------
    파일 입출력 작업을 모두 완료하면 반드시 파일을 닫아야 하는데 이 때 close() 함수를 사용한다.
    한 프로세스가 열 수 있는 파일 개수에 제한이 있으므로 파일을 제대로 닫지 않으면 최대 허용 개수를 초과해 더 이상 파일을 열지 못할 수 있다.

  파일
