# Chapter 2 디렉토리 다루기

## 1. 리눅스 파일의 특징

  리눅스에서 파일은 데이터 저장, 장치 구동, 프로세스 간 통신 등에 사용함.

  ### 파일의 종류

    일반 파일 </br>
      텍스트 파일, 실행 파일, 라이브러리, 이미지 등 대부분의 파일 </br>
      데이터 블록에 텍스트나 바이너리 형태의 데이터를 저장하고 있다.

    특수 파일 </br>
      통신을 하거나 터미널 또는 디스크 등의 장치를 사용하려면 연관된 특수 파일을 사용해야 한다. </br>
      장치 관련 특수 파일을 다른 파일과 구분해 장치 파일이라고 한다. </br>
      장치 파일은 데이터 블록을 사용하지 않는다. 대신 장치의 종류를 나타내는 장치 번호를 inode에 저장한다. </br>
      장치 파일에는 블록 장치 파일과 문자 장치 파일이 있다. </br>
      블록 장치 파일은 블록 단위로 데이터를 읽고 쓴다. 블록 크기는 1~8KB사이에서 조정 가능. </br>
      문자 장치 파일은 하드 디스크인 경우 섹터 단위로 읽고 쓰는데, 리눅스에서 기본 크기는 521bytes다. 로우 디바이스(raw device)라고 부른다. </br>
      장치 파일은 ls -l 명령의 결과에서 파일의 크기를 나타내는 부분이 일반 파일과 달리 10~175 형태로 출력됨.

    디렉토리 </br>
      리눅스에서는 디렉토리도 파일로 취급함. </br>
      디렉토리와 연관된 데이터 블록은 해당 디렉토리에 속한 파일의 목록과 inode를 저장. </br>
      디렉토리를 생성하려면 mkdir, 삭제하려면 rmdir 또는 rm, 복사하려면 cp -r 명령을 사용함.

    파일의 종류 구분 </br>
      ls -l 명령의 결과 중 파일의 권한을 표시하는 -rwxr-xr-x에서 맨 앞의 하이픈(-)이 파일의 종류를 나타낸다. </br>
      - : 일반 파일
      d : 디렉토리
      b : 블록 장치 특수 파일
      c : 문자 장치 특수 파일
      l : 심벌릭 링크

  ### 파일의 구성 요소

    파일명 </br>
      사용자가 파일에 접근할 때 사용하며 파일명과 관련된 inode가 반드시 있어야 한다. 255바이트보다 긴 파일명까지 사용 가능하다. </br>
      파일명과 디렉토리명에 사용하는 알파벳은 대소문자를 구분. </br>
      파일명과 디렉토리명이 '.'으로 시작하면 숨김 파일로 간주함.

    inode </br>
      파일에 대한 정보를 저장하고 있는 객체로, 실제 디스크에 저장되어 있음. </br>
      외부적으로는 번호로 표현, 내부적으로는 두 부분으로 나누어 정보를 저장함. </br>
      첫번째 부분에는 파일에 관한 정보가 저장됨. </br>
      파일에 관한 정보에는 파일 종류, 파일 접근 권한, 파일 크기, 소유자, 소유 그룹, 파일 변경 시각, 하드 링크 수, 데이터 블록 수 등이 있다. </br>
      두번째 부분에는 파일의 실제 데이터가 저장되어 있는 데이터 블록의 위치를 나타내는 주소들이 저장된다. </br>
      파일의 inode 번호는 ls -i 명령으로 알 수 있다.

    데이터 블록 </br>
      실제로 데이터가 저장되는 하드 디스크의 공간이다. </br>
      일반 파일이나 디렉토리, 심볼릭 링크는 데이터 블록에 관련 내용을 직접 저장하지만, 장치 파일은 데이터 블록을 사용하지 않고 장치에 관한 정보를 inode에 저장한다.

## 2. 디렉토리 생성과 삭제

    mkdir(): 디렉토리 생성
    ---------------------------------------------
    #include <sys/stat.h>
    #include <sys/types.h>

    int mkdir(const char *pathname, mode_t mode);

    * pathname: 디렉토리가 포함된 경로
    * mode: 접근 권한
    ---------------------------------------------
    생성하려는 디렉토리명을 포함한 경로를 받고, 생성하는 디렉토리의 기본 접근 권한을 지정한다.

    rmdir(): 디렉토리 삭제
    ---------------------------------------------
    #include <unistd.h>

    int rmdir(const char *pathname);

    * pathname: 삭제할 경로
    ---------------------------------------------
    삭제하려는 디렉토리명을 포함한 경로를 인자로 받는다.

## 3. 디렉토리 관리

  ### 현재 작업 디렉토리의 위치 검색

    getcwd(): 현재 작업 디렉토리의 위치 검색 1
    ---------------------------------------------
    #include <unistd.h>

    char *getcwd(char *buf, size_t size);

    * buf: 현재 디렉토리의 절대 경로를 저장할 버퍼 주소
    * size: 버퍼의 크기
    ---------------------------------------------
    경로를 저장할 버퍼의 주소와 버퍼의 크기를 인자로 받는다.
    인자를 지정하는 방법은 다음과 같다.
      1. buf에 경로를 저장할 만큼 충분한 메모리를 할당하고 그 크기를 size에 저장함.
      2. buf에 NULL을 지정하고 할당이 필요한 메모리 크기를 size에 지정함.
      3. buf에 NULL을 지정하고 size는 0으로 지정함.

    get_current_dir_name(): ㅗ현재 작업 디렉토리 위치 검색 2
    ---------------------------------------------
    #include <unistd.h>

    char *get_current_dir_name(void);

    * void: 함수로 전달한 인자가 없다는 뜻이다.
    ---------------------------------------------
    인자로 아무것도 전달하지 않으며, 시스템이 메모리를 자동으로 할당해 경로를 저장하고 리턴한다. getcwd(NULL, 0)와 같은 방식으로 동작.

  ### 디렉토리명 변경
    rename(): 디렉토리명 변경
    ---------------------------------------------
    #include <stdio.h>

    int rename(const char *oldpath, const char *newpath);

    * oldpath: 변경할 파일/디렉토리명
    * newpath: 새 파일/디렉토리명
    ---------------------------------------------
    두번째 인자로 지정한 이름이 이미 있으면 해당 디렉토리를 지움.
    실행 도중 오류가 발생하면 원본과 새로운 디렉토리명이 모두 남는다.
    파일명을 변경하는데도 사용 가능.
  
  ### 디렉토리 이동
    chdir(): 디렉토리 이동 1
    ---------------------------------------------
    #include <unistd.h>

    int chdir(const char *path);

    * path: 이동하려는 디렉토리 경로
    ---------------------------------------------
