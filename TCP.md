# TCP 기반 프로그래밍

네트워크를 기반으로 하는 통신 프로그램은 일반적으로 서버와 클라이언트로 역할을 구분한다. </br>
그중 서버 컴퓨터에서 동작하며 서비스를 제공하는 프로그램을 데몬 프로세스라고 한다.

반복 실행 서버: 데몬 프로세스가 직접 모든 클라이언트의 요청을 차례로 처리한다. </br>
동시 동작 서버: 데몬 프로세스가 직접 서비스를 제공하지 않고 서비스와 관련 있는 다른 프로세스를 fork() 함수로 생성해 클라이언트와 연결한다. 

## 1. 반복 실행 서버

반복 실행 서버는 서버 프로그램이 클라이언트의 요청을 직접 처리한다. </br>
따라서 한번에 한 클라이언트의 요청만 처리할 수 있고 여러 클라이언트가 서비스를 요청할 경우 순차적으로 처리되므로 클라이언트가 자기 순서를 기다려야 한다. </br>
이를 방지하기 위해 반복 실행 서버 프로세스를 여러 개 동작시킬 수 있다.

반복 실행 서버는 인터넷 소켓과 TCP(SOCK_STREAM)를 이용해 통신한다. 서버는 계속 동작하면서 클라이언트가 요청하는 서비스를 받아 처리한다.

## 2. 동시 동작 서버

반복 실행 서버는 서버 프로그램이 클라이언트의 요청을 직접 처리한다. 그러나 클라이언트의 요청에 따라 수행해야 할 작업이 많은 경우에는 </br>
클라이언트가 대기하는 시간이 길어진다는 단점이 있다. 이를 해결하기 위해 동시 동작 서버 구조를 이용한다.

서버 프로그램은 클라이언트의 서비스를 대신 처리할 프로세스를 fork() 함수로 생성하고 이 프로세스를 클라이언트와 연결한 다음 다시 클라이언트의 접속을 기다린다. </br>
이렇게 하면 동시에 여러 클라이언트에 서비스를 제공할 수 있다.

## 3. 동시 동작 서버: exec() 함수로 서비스 프로세스 호출

서버 프로세스가 클라이언트의 요청을 받으면 fork() 함수를 호출해 자식 프로세스를 생성한 후 exec() 함수로 다른 프로세스를 실행한다. </br>
이는 inetd 같은 대표 데몬 프로세스가 텔넷이나 FTP 같은 서비스 요청을 받아 해당 서비스 프로세스를 호출하는 것과 유사하다.

## 4. 동시 동작 서버: 명령행 인자로 소켓 기술자 전달

서버 프로그램에서 클라이언트와 연결하는 소켓 기술자를 exec() 함수로 호출하는 프로세스에 명령행 인자로 전달하도록 지정한다. </br>
따라서 exec() 함수로 실행한 서비스 프로세스는 명령행 인자로 전달받은 소켓 기술자로 클라이언트와 통신한다.
